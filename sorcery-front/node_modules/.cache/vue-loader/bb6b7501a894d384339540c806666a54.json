{"remainingRequest":"/Users/lvjing/web-project/sorcery-hogwarts/sorcery-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lvjing/web-project/sorcery-hogwarts/sorcery-front/src/components/project/Task.vue?vue&type=style&index=0&id=61a4216b&scoped=true&lang=css&","dependencies":[{"path":"/Users/lvjing/web-project/sorcery-hogwarts/sorcery-front/src/components/project/Task.vue","mtime":1663227236663},{"path":"/Users/lvjing/web-project/sorcery-hogwarts/sorcery-front/node_modules/css-loader/dist/cjs.js","mtime":1663752625181},{"path":"/Users/lvjing/web-project/sorcery-hogwarts/sorcery-front/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1663752598650},{"path":"/Users/lvjing/web-project/sorcery-hogwarts/sorcery-front/node_modules/postcss-loader/src/index.js","mtime":1663752611807},{"path":"/Users/lvjing/web-project/sorcery-hogwarts/sorcery-front/node_modules/cache-loader/dist/cjs.js","mtime":1663752628994},{"path":"/Users/lvjing/web-project/sorcery-hogwarts/sorcery-front/node_modules/vue-loader/lib/index.js","mtime":1663752598514}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5idG4gewogIG1hcmdpbjogM3B4Owp9Cg=="},{"version":3,"sources":["Task.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6MA;AACA;AACA","file":"Task.vue","sourceRoot":"src/components/project","sourcesContent":["<template>\n  <div>\n    <!--Task信息列表-->\n    <v-data-table\n        :headers=\"headers\"\n        :items=\"desserts\"\n        class=\"elevation-1\"\n        hide-default-footer\n    >\n      <template v-slot:item.status=\"{item}\">\n        <div v-if=\"item.status===0\">无效</div>\n        <div v-else-if=\"item.status===1\">新建</div>\n        <div v-else-if=\"item.status===2\">执行中</div>\n        <div v-else-if=\"item.status===3\"><a @click=\"getAllure(item)\">执行完成</a></div>\n      </template>\n\n      <template v-slot:item.shortTestCommand=\"{item}\">\n        <v-hover v-slot:default=\"{hover}\">\n          <div>\n            <span class=\"short-test-command\">{{ item.testCommand }}</span>\n            <div v-if=\"hover\" class=\" transition-fast-in-fast-out grey v-card--reveal test-command\">\n              {{ item.testCommand }}\n            </div>\n          </div>\n        </v-hover>\n      </template>\n\n      <template v-slot:item.action=\"{item}\">\n        <!--执行状态为1（新建）则可以点击执行-->\n        <v-btn v-if=\"item.status===1\" color=\"primary\" small @click=\"doTask(item)\" class=\"btn\">执行任务</v-btn>\n        <v-btn small v-else disabled>执行任务</v-btn>\n        <v-btn color=\"success\" small @click=\"editTask(item)\" class=\"btn\">编辑</v-btn>\n        <v-btn color=\"error\" small @click=\"deleteTask(item)\" class=\"btn\">删除</v-btn>\n      </template>\n    </v-data-table>\n\n    <!--编辑测试任务-->\n    <v-dialog v-model=\"editDialog\" width=\"400px\">\n      <v-card>\n        <v-card-title>编辑任务</v-card-title>\n        <v-card-text>\n          <v-text-field label=\"任务名称\" v-model=\"taskName\"></v-text-field>\n          <v-text-field label=\"备注\" v-model=\"remark\"></v-text-field>\n        </v-card-text>\n        <v-card-actions>\n          <v-spacer>\n            <v-btn color=\"primary\" text @click=\"editDialog=false\">取消</v-btn>\n            <v-btn color=\"primary\" @click=\"saveEdit()\">确认</v-btn>\n          </v-spacer>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n\n    <!--分页显示处理-->\n    <v-pagination v-if=\"pageLength>0\" v-model=\"currentPage\" :length=\"pageLength\" @input=\"getTaskList()\"\n                  total-visible=\"7\"></v-pagination>\n  </div>\n</template>\n<script>\nexport default {\n  data() {\n    return {\n      editDialog: false,\n      taskName: '',\n      remark: '',\n      headers: [\n        {text: 'ID', value: 'id'},\n        {text: '测试任务名称', value: 'name'},\n        {text: 'JenkinsId', value: 'testJenkinsId'},\n        {text: '测试用例数量', value: 'caseCount'},\n        {text: '执行脚本', value: 'testCommand'},\n        {text: '执行状态', value: 'status'},\n        {text: '操作', value: 'action'},\n      ],\n      desserts: [],\n      currentPage: 1,\n      pageLength: 0\n    }\n  },\n  created() {\n    this.getTaskList()\n  },\n  methods: {\n    // 编辑测试任务\n    editTask(item) {\n      this.taskName = item.name\n      this.remark = item.remark\n      this.editId = item.id\n      this.editDialog = true\n    },\n    // 保存编辑的测试任务\n    saveEdit() {\n      let params = {\n        name: this.taskName,\n        remark: this.remark,\n        id: this.editId\n      }\n      this.$api.task.editTask(params).then(res => {\n        // 调用接口，返回resultCode=1，说明接口调用成功\n        if (res.data.resultCode === 1) {\n          if (this.instanceNotify) {\n            this.instanceNotify.close()\n          }\n          this.instanceNotify = this.$notify({\n            title: '成功',\n            message: '编辑成功',\n            type: 'success'\n          })\n          this.getTaskList()\n          this.editDialog = false\n        } else {\n          if (this.notifyInstance) {\n            this.notifyInstance.close()\n          }\n          this.notifyInstance = this.$notify({\n            title: '错误',\n            message: res.data.message,\n            type: 'error'\n          })\n        }\n      })\n    },\n    // 删除测试任务\n    deleteTask(item) {\n      let params = {\n        id: item.id\n      }\n      this.$api.task.deleteTask(params).then(res => {\n        // 调用接口，返回resultCode=1，说明接口调用成功\n        if (res.data.resultCode === 1) {\n          if (this.instanceNotify) {\n            this.instanceNotify.close()\n          }\n          this.instanceNotify = this.$notify({\n            title: '成功',\n            message: '删除成功',\n            type: 'success'\n          })\n          this.getTaskList()\n        } else {\n          if (this.notifyInstance) {\n            this.notifyInstance.close()\n          }\n          this.notifyInstance = this.$notify({\n            title: '错误',\n            message: res.data.message,\n            type: 'error'\n          })\n        }\n      })\n    },\n    // 测试任务列表\n    getTaskList() {\n      let params = {\n        pageNum: this.currentPage,\n        pageSize: 10,\n      }\n      this.$api.task.getTaskList(params).then(res => {\n        this.desserts = res.data.data.data\n        this.rows = res.data.data.recordsTotal\n        this.pageLength = Math.ceil(this.rows / 10)\n      })\n    },\n    // 执行测试任务\n    doTask(item) {\n      let params = {\n        taskId: item.id\n      }\n      this.$api.task.doTask(params).then(res => {\n        if (res.data.resultCode === 1) {\n          if (this.instanceNotify) {\n            this.instanceNotify.close()\n          }\n          this.instanceNotify = this.$notify({\n            title: '成功',\n            message: '测试任务执行',\n            type: 'success'\n          })\n          this.getTaskList()\n        } else {\n          if (this.notifyInstance) {\n            this.notifyInstance.close()\n          }\n          this.notifyInstance = this.$notify({\n            title: '错误',\n            message: res.data.message,\n            type: 'error'\n          })\n        }\n      })\n    },\n    // 获取测试报告\n    getAllure(item) {\n      let params = {\n        id: item.id\n      }\n      this.$api.report.getAllure(params).then(res => {\n        // _blank打开新的窗口，浏览器窗口跳转\n        window.open(res.data.data.allureReportUrl, \"_blank\")\n      })\n    },\n  }\n}\n</script>\n<style scoped>\n.btn {\n  margin: 3px;\n}\n</style>\n"]}]}