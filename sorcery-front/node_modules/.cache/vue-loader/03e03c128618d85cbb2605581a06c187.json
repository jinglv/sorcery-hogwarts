{"remainingRequest":"/Users/lvjing/web-project/sorcery-hogwarts/sorcery-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lvjing/web-project/sorcery-hogwarts/sorcery-front/src/components/project/Task.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lvjing/web-project/sorcery-hogwarts/sorcery-front/src/components/project/Task.vue","mtime":1663227236663},{"path":"/Users/lvjing/web-project/sorcery-hogwarts/sorcery-front/node_modules/cache-loader/dist/cjs.js","mtime":1663752628994},{"path":"/Users/lvjing/web-project/sorcery-hogwarts/sorcery-front/node_modules/babel-loader/lib/index.js","mtime":1663752630001},{"path":"/Users/lvjing/web-project/sorcery-hogwarts/sorcery-front/node_modules/cache-loader/dist/cjs.js","mtime":1663752628994},{"path":"/Users/lvjing/web-project/sorcery-hogwarts/sorcery-front/node_modules/vue-loader/lib/index.js","mtime":1663752598514}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZWRpdERpYWxvZzogZmFsc2UsCiAgICAgIHRhc2tOYW1lOiAnJywKICAgICAgcmVtYXJrOiAnJywKICAgICAgaGVhZGVyczogWwogICAgICAgIHt0ZXh0OiAnSUQnLCB2YWx1ZTogJ2lkJ30sCiAgICAgICAge3RleHQ6ICfmtYvor5Xku7vliqHlkI3np7AnLCB2YWx1ZTogJ25hbWUnfSwKICAgICAgICB7dGV4dDogJ0plbmtpbnNJZCcsIHZhbHVlOiAndGVzdEplbmtpbnNJZCd9LAogICAgICAgIHt0ZXh0OiAn5rWL6K+V55So5L6L5pWw6YePJywgdmFsdWU6ICdjYXNlQ291bnQnfSwKICAgICAgICB7dGV4dDogJ+aJp+ihjOiEmuacrCcsIHZhbHVlOiAndGVzdENvbW1hbmQnfSwKICAgICAgICB7dGV4dDogJ+aJp+ihjOeKtuaAgScsIHZhbHVlOiAnc3RhdHVzJ30sCiAgICAgICAge3RleHQ6ICfmk43kvZwnLCB2YWx1ZTogJ2FjdGlvbid9LAogICAgICBdLAogICAgICBkZXNzZXJ0czogW10sCiAgICAgIGN1cnJlbnRQYWdlOiAxLAogICAgICBwYWdlTGVuZ3RoOiAwCiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRUYXNrTGlzdCgpCiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyDnvJbovpHmtYvor5Xku7vliqEKICAgIGVkaXRUYXNrKGl0ZW0pIHsKICAgICAgdGhpcy50YXNrTmFtZSA9IGl0ZW0ubmFtZQogICAgICB0aGlzLnJlbWFyayA9IGl0ZW0ucmVtYXJrCiAgICAgIHRoaXMuZWRpdElkID0gaXRlbS5pZAogICAgICB0aGlzLmVkaXREaWFsb2cgPSB0cnVlCiAgICB9LAogICAgLy8g5L+d5a2Y57yW6L6R55qE5rWL6K+V5Lu75YqhCiAgICBzYXZlRWRpdCgpIHsKICAgICAgbGV0IHBhcmFtcyA9IHsKICAgICAgICBuYW1lOiB0aGlzLnRhc2tOYW1lLAogICAgICAgIHJlbWFyazogdGhpcy5yZW1hcmssCiAgICAgICAgaWQ6IHRoaXMuZWRpdElkCiAgICAgIH0KICAgICAgdGhpcy4kYXBpLnRhc2suZWRpdFRhc2socGFyYW1zKS50aGVuKHJlcyA9PiB7CiAgICAgICAgLy8g6LCD55So5o6l5Y+j77yM6L+U5ZuecmVzdWx0Q29kZT0x77yM6K+05piO5o6l5Y+j6LCD55So5oiQ5YqfCiAgICAgICAgaWYgKHJlcy5kYXRhLnJlc3VsdENvZGUgPT09IDEpIHsKICAgICAgICAgIGlmICh0aGlzLmluc3RhbmNlTm90aWZ5KSB7CiAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VOb3RpZnkuY2xvc2UoKQogICAgICAgICAgfQogICAgICAgICAgdGhpcy5pbnN0YW5jZU5vdGlmeSA9IHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgIHRpdGxlOiAn5oiQ5YqfJywKICAgICAgICAgICAgbWVzc2FnZTogJ+e8lui+keaIkOWKnycsCiAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJwogICAgICAgICAgfSkKICAgICAgICAgIHRoaXMuZ2V0VGFza0xpc3QoKQogICAgICAgICAgdGhpcy5lZGl0RGlhbG9nID0gZmFsc2UKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHRoaXMubm90aWZ5SW5zdGFuY2UpIHsKICAgICAgICAgICAgdGhpcy5ub3RpZnlJbnN0YW5jZS5jbG9zZSgpCiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLm5vdGlmeUluc3RhbmNlID0gdGhpcy4kbm90aWZ5KHsKICAgICAgICAgICAgdGl0bGU6ICfplJnor68nLAogICAgICAgICAgICBtZXNzYWdlOiByZXMuZGF0YS5tZXNzYWdlLAogICAgICAgICAgICB0eXBlOiAnZXJyb3InCiAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICAvLyDliKDpmaTmtYvor5Xku7vliqEKICAgIGRlbGV0ZVRhc2soaXRlbSkgewogICAgICBsZXQgcGFyYW1zID0gewogICAgICAgIGlkOiBpdGVtLmlkCiAgICAgIH0KICAgICAgdGhpcy4kYXBpLnRhc2suZGVsZXRlVGFzayhwYXJhbXMpLnRoZW4ocmVzID0+IHsKICAgICAgICAvLyDosIPnlKjmjqXlj6PvvIzov5Tlm55yZXN1bHRDb2RlPTHvvIzor7TmmI7mjqXlj6PosIPnlKjmiJDlip8KICAgICAgICBpZiAocmVzLmRhdGEucmVzdWx0Q29kZSA9PT0gMSkgewogICAgICAgICAgaWYgKHRoaXMuaW5zdGFuY2VOb3RpZnkpIHsKICAgICAgICAgICAgdGhpcy5pbnN0YW5jZU5vdGlmeS5jbG9zZSgpCiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmluc3RhbmNlTm90aWZ5ID0gdGhpcy4kbm90aWZ5KHsKICAgICAgICAgICAgdGl0bGU6ICfmiJDlip8nLAogICAgICAgICAgICBtZXNzYWdlOiAn5Yig6Zmk5oiQ5YqfJywKICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgICB9KQogICAgICAgICAgdGhpcy5nZXRUYXNrTGlzdCgpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmICh0aGlzLm5vdGlmeUluc3RhbmNlKSB7CiAgICAgICAgICAgIHRoaXMubm90aWZ5SW5zdGFuY2UuY2xvc2UoKQogICAgICAgICAgfQogICAgICAgICAgdGhpcy5ub3RpZnlJbnN0YW5jZSA9IHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgbWVzc2FnZTogcmVzLmRhdGEubWVzc2FnZSwKICAgICAgICAgICAgdHlwZTogJ2Vycm9yJwogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgLy8g5rWL6K+V5Lu75Yqh5YiX6KGoCiAgICBnZXRUYXNrTGlzdCgpIHsKICAgICAgbGV0IHBhcmFtcyA9IHsKICAgICAgICBwYWdlTnVtOiB0aGlzLmN1cnJlbnRQYWdlLAogICAgICAgIHBhZ2VTaXplOiAxMCwKICAgICAgfQogICAgICB0aGlzLiRhcGkudGFzay5nZXRUYXNrTGlzdChwYXJhbXMpLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLmRlc3NlcnRzID0gcmVzLmRhdGEuZGF0YS5kYXRhCiAgICAgICAgdGhpcy5yb3dzID0gcmVzLmRhdGEuZGF0YS5yZWNvcmRzVG90YWwKICAgICAgICB0aGlzLnBhZ2VMZW5ndGggPSBNYXRoLmNlaWwodGhpcy5yb3dzIC8gMTApCiAgICAgIH0pCiAgICB9LAogICAgLy8g5omn6KGM5rWL6K+V5Lu75YqhCiAgICBkb1Rhc2soaXRlbSkgewogICAgICBsZXQgcGFyYW1zID0gewogICAgICAgIHRhc2tJZDogaXRlbS5pZAogICAgICB9CiAgICAgIHRoaXMuJGFwaS50YXNrLmRvVGFzayhwYXJhbXMpLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzLmRhdGEucmVzdWx0Q29kZSA9PT0gMSkgewogICAgICAgICAgaWYgKHRoaXMuaW5zdGFuY2VOb3RpZnkpIHsKICAgICAgICAgICAgdGhpcy5pbnN0YW5jZU5vdGlmeS5jbG9zZSgpCiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmluc3RhbmNlTm90aWZ5ID0gdGhpcy4kbm90aWZ5KHsKICAgICAgICAgICAgdGl0bGU6ICfmiJDlip8nLAogICAgICAgICAgICBtZXNzYWdlOiAn5rWL6K+V5Lu75Yqh5omn6KGMJywKICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgICB9KQogICAgICAgICAgdGhpcy5nZXRUYXNrTGlzdCgpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmICh0aGlzLm5vdGlmeUluc3RhbmNlKSB7CiAgICAgICAgICAgIHRoaXMubm90aWZ5SW5zdGFuY2UuY2xvc2UoKQogICAgICAgICAgfQogICAgICAgICAgdGhpcy5ub3RpZnlJbnN0YW5jZSA9IHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgbWVzc2FnZTogcmVzLmRhdGEubWVzc2FnZSwKICAgICAgICAgICAgdHlwZTogJ2Vycm9yJwogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgLy8g6I635Y+W5rWL6K+V5oql5ZGKCiAgICBnZXRBbGx1cmUoaXRlbSkgewogICAgICBsZXQgcGFyYW1zID0gewogICAgICAgIGlkOiBpdGVtLmlkCiAgICAgIH0KICAgICAgdGhpcy4kYXBpLnJlcG9ydC5nZXRBbGx1cmUocGFyYW1zKS50aGVuKHJlcyA9PiB7CiAgICAgICAgLy8gX2JsYW5r5omT5byA5paw55qE56qX5Y+j77yM5rWP6KeI5Zmo56qX5Y+j6Lez6L2sCiAgICAgICAgd2luZG93Lm9wZW4ocmVzLmRhdGEuZGF0YS5hbGx1cmVSZXBvcnRVcmwsICJfYmxhbmsiKQogICAgICB9KQogICAgfSwKICB9Cn0K"},{"version":3,"sources":["Task.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Task.vue","sourceRoot":"src/components/project","sourcesContent":["<template>\n  <div>\n    <!--Task信息列表-->\n    <v-data-table\n        :headers=\"headers\"\n        :items=\"desserts\"\n        class=\"elevation-1\"\n        hide-default-footer\n    >\n      <template v-slot:item.status=\"{item}\">\n        <div v-if=\"item.status===0\">无效</div>\n        <div v-else-if=\"item.status===1\">新建</div>\n        <div v-else-if=\"item.status===2\">执行中</div>\n        <div v-else-if=\"item.status===3\"><a @click=\"getAllure(item)\">执行完成</a></div>\n      </template>\n\n      <template v-slot:item.shortTestCommand=\"{item}\">\n        <v-hover v-slot:default=\"{hover}\">\n          <div>\n            <span class=\"short-test-command\">{{ item.testCommand }}</span>\n            <div v-if=\"hover\" class=\" transition-fast-in-fast-out grey v-card--reveal test-command\">\n              {{ item.testCommand }}\n            </div>\n          </div>\n        </v-hover>\n      </template>\n\n      <template v-slot:item.action=\"{item}\">\n        <!--执行状态为1（新建）则可以点击执行-->\n        <v-btn v-if=\"item.status===1\" color=\"primary\" small @click=\"doTask(item)\" class=\"btn\">执行任务</v-btn>\n        <v-btn small v-else disabled>执行任务</v-btn>\n        <v-btn color=\"success\" small @click=\"editTask(item)\" class=\"btn\">编辑</v-btn>\n        <v-btn color=\"error\" small @click=\"deleteTask(item)\" class=\"btn\">删除</v-btn>\n      </template>\n    </v-data-table>\n\n    <!--编辑测试任务-->\n    <v-dialog v-model=\"editDialog\" width=\"400px\">\n      <v-card>\n        <v-card-title>编辑任务</v-card-title>\n        <v-card-text>\n          <v-text-field label=\"任务名称\" v-model=\"taskName\"></v-text-field>\n          <v-text-field label=\"备注\" v-model=\"remark\"></v-text-field>\n        </v-card-text>\n        <v-card-actions>\n          <v-spacer>\n            <v-btn color=\"primary\" text @click=\"editDialog=false\">取消</v-btn>\n            <v-btn color=\"primary\" @click=\"saveEdit()\">确认</v-btn>\n          </v-spacer>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n\n    <!--分页显示处理-->\n    <v-pagination v-if=\"pageLength>0\" v-model=\"currentPage\" :length=\"pageLength\" @input=\"getTaskList()\"\n                  total-visible=\"7\"></v-pagination>\n  </div>\n</template>\n<script>\nexport default {\n  data() {\n    return {\n      editDialog: false,\n      taskName: '',\n      remark: '',\n      headers: [\n        {text: 'ID', value: 'id'},\n        {text: '测试任务名称', value: 'name'},\n        {text: 'JenkinsId', value: 'testJenkinsId'},\n        {text: '测试用例数量', value: 'caseCount'},\n        {text: '执行脚本', value: 'testCommand'},\n        {text: '执行状态', value: 'status'},\n        {text: '操作', value: 'action'},\n      ],\n      desserts: [],\n      currentPage: 1,\n      pageLength: 0\n    }\n  },\n  created() {\n    this.getTaskList()\n  },\n  methods: {\n    // 编辑测试任务\n    editTask(item) {\n      this.taskName = item.name\n      this.remark = item.remark\n      this.editId = item.id\n      this.editDialog = true\n    },\n    // 保存编辑的测试任务\n    saveEdit() {\n      let params = {\n        name: this.taskName,\n        remark: this.remark,\n        id: this.editId\n      }\n      this.$api.task.editTask(params).then(res => {\n        // 调用接口，返回resultCode=1，说明接口调用成功\n        if (res.data.resultCode === 1) {\n          if (this.instanceNotify) {\n            this.instanceNotify.close()\n          }\n          this.instanceNotify = this.$notify({\n            title: '成功',\n            message: '编辑成功',\n            type: 'success'\n          })\n          this.getTaskList()\n          this.editDialog = false\n        } else {\n          if (this.notifyInstance) {\n            this.notifyInstance.close()\n          }\n          this.notifyInstance = this.$notify({\n            title: '错误',\n            message: res.data.message,\n            type: 'error'\n          })\n        }\n      })\n    },\n    // 删除测试任务\n    deleteTask(item) {\n      let params = {\n        id: item.id\n      }\n      this.$api.task.deleteTask(params).then(res => {\n        // 调用接口，返回resultCode=1，说明接口调用成功\n        if (res.data.resultCode === 1) {\n          if (this.instanceNotify) {\n            this.instanceNotify.close()\n          }\n          this.instanceNotify = this.$notify({\n            title: '成功',\n            message: '删除成功',\n            type: 'success'\n          })\n          this.getTaskList()\n        } else {\n          if (this.notifyInstance) {\n            this.notifyInstance.close()\n          }\n          this.notifyInstance = this.$notify({\n            title: '错误',\n            message: res.data.message,\n            type: 'error'\n          })\n        }\n      })\n    },\n    // 测试任务列表\n    getTaskList() {\n      let params = {\n        pageNum: this.currentPage,\n        pageSize: 10,\n      }\n      this.$api.task.getTaskList(params).then(res => {\n        this.desserts = res.data.data.data\n        this.rows = res.data.data.recordsTotal\n        this.pageLength = Math.ceil(this.rows / 10)\n      })\n    },\n    // 执行测试任务\n    doTask(item) {\n      let params = {\n        taskId: item.id\n      }\n      this.$api.task.doTask(params).then(res => {\n        if (res.data.resultCode === 1) {\n          if (this.instanceNotify) {\n            this.instanceNotify.close()\n          }\n          this.instanceNotify = this.$notify({\n            title: '成功',\n            message: '测试任务执行',\n            type: 'success'\n          })\n          this.getTaskList()\n        } else {\n          if (this.notifyInstance) {\n            this.notifyInstance.close()\n          }\n          this.notifyInstance = this.$notify({\n            title: '错误',\n            message: res.data.message,\n            type: 'error'\n          })\n        }\n      })\n    },\n    // 获取测试报告\n    getAllure(item) {\n      let params = {\n        id: item.id\n      }\n      this.$api.report.getAllure(params).then(res => {\n        // _blank打开新的窗口，浏览器窗口跳转\n        window.open(res.data.data.allureReportUrl, \"_blank\")\n      })\n    },\n  }\n}\n</script>\n<style scoped>\n.btn {\n  margin: 3px;\n}\n</style>\n"]}]}